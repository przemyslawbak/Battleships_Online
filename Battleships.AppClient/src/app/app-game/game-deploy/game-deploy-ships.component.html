<div class="gameHeaderPic col-sm rounded-top"></div>
<div class="row">
  <div class="col-lg-5">
    <!--game status-->
    <div class="col-sm-12 gameStatus dataRow">
      <h2 class="form-title">Ship deployment</h2>
      <div *ngIf="this.isDeploymentAllowed; then deploying; else waiting"></div>
      <ng-template #deploying>
        <div class="row">
          <div *ngIf="this.isDeployed; then deployed; else notDeployed"></div>
          <ng-template #notDeployed>
            <div class="row">
              <div class="col-sm-6">
                <div>Deploy ships:</div>
                <h4 [ngClass]="this.count < 30 ? 'redColor' : 'greenColor'">
                  {{ count }} s.
                </h4>
                <div>Remaining ships:</div>
                <h4>{{ this.getFleetWaiting().length }}</h4>
              </div>
              <div class="ships col-sm-6">
                <div>(click to rotate)</div>
                <div class="droplist col-sm-6">
                  <div *ngIf="this.getFleetWaiting().length > 0">
                    <div
                      [style.size]="30 * this.getFleetWaiting()[0].size + 'px'"
                    >
                      <app-ship
                        #nextItem
                        [ngClass]="
                          this.getFleetWaiting()[0].rotation === 90
                            ? 'rotate'
                            : 'rotateNot'
                        "
                        [size]="this.getFleetWaiting()[0].size"
                        (click)="setRotation(0 + '-fleetWaiting')"
                      ></app-ship>
                    </div>
                  </div>
                </div>
              </div>
            </div>
          </ng-template>
          <ng-template #deployed>
            <div class="col-sm-12">
              Waiting for second player to finish deploying...
            </div>
          </ng-template>
        </div>
      </ng-template>
      <ng-template #waiting>
        <div class="row">
          <h4 class="col-sm-12 redColor">
            Waiting for second player to join this game...
          </h4>
          <div class="text-center gameStatus">
            <button
              [disabled]="this.isStartAllowed"
              type="submit"
              class="btn btn-md btn-success"
              (click)="playWithAi()"
            >
              Play vs AI
            </button>
            <div class="col-sm-12 link">
              Link for your friends to join this game:
            </div>
            <button
              type="button"
              class="btn btn-md btn-primary linkBtn"
              (click)="copyToClipboard()"
            >
              Copy link to the clipoard
            </button>
            <button
              type="button"
              class="btn btn-md btn-primary linkBtn"
              (click)="shareOnFacebook()"
            >
              Share link on Facebook
            </button>
          </div>
        </div>
      </ng-template>
    </div>
    <!--game chat-->
    <game-chat
      [userName]="this.userName"
      [multiplayer]="this.multiplayer"
    ></game-chat>
  </div>
  <div class="droplist col-lg-7">
    <game-setup></game-setup>
    <!--buttons-->
    <div class="text-center">
      <button
        [disabled]="this.isDeployed"
        [disabled]="!this.isDeploymentAllowed"
        type="submit"
        class="btn btn-md btn-light"
        (click)="clearBoard()"
      >
        Clear board
      </button>
      <button
        [disabled]="this.isDeployed"
        [disabled]="!this.isDeploymentAllowed"
        type="submit"
        class="btn btn-md btn-light"
        (click)="autoDeploying()"
      >
        Auto deploy
      </button>
      <button
        [disabled]="
          !this.isDeployEnabled || this.isDeployed || !this.isDeploymentAllowed
        "
        type="submit"
        class="btn btn-md btn-success"
        (click)="confirm()"
      >
        Deploy ships
      </button>
    </div>
    <!--board-->
    <div class="board text-center" #board>
      <div
        class="boardRow"
        *ngFor="let row of this.getPlayersBoard(); let i = index"
      >
        <div *ngFor="let box of row; let j = index">
          <div
            [ngClass]="{ boardCell: true, pointer: this.isDeploymentAllowed }"
            [style.backgroundColor]="box.color"
            #cell
            (mouseleave)="resetBoardElement(cell, j, i)"
            (mouseover)="checkHoveredElement(j, i, cell)"
            (click)="deployShip(j, i)"
          ></div>
        </div>
      </div>
    </div>
  </div>
</div>
